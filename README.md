# â˜ï¸ go-pg-gqlgen â€“ Full-Stack Multi-Cloud Infra-as-Code + GraphQL API

This project is a **multi-cloud infrastructure orchestration and management backend** built with:

- Go (Golang)
- gqlgen for GraphQL APIs
- PostgreSQL for metadata persistence
- AWS and OCI SDKs for cloud resource provisioning

It programmatically creates cloud infrastructure and exposes a **GraphQL playground** to manage both cloud resources and the relational schemaâ€”all with real-time write-back to the database.

---

## ğŸ¯ Project Purpose

This repo simulates a **unified cloud control plane** that allows:

- Declarative creation of AWS/OCI resources (VPCs, EC2, Subnets, etc.)
- Tracking metadata in a PostgreSQL DB
- GraphQL-based CRUD operations via auto-generated schemas
- Infrastructure automation via GraphQL mutations

Ideal for:

- Learning IaC, gqlgen, and Go ORM patterns
- Creating cloud resource catalogs
- Building internal developer platforms (IDPs)

---

## ğŸ“¦ Features

- âœ… Provision VPC, Subnet, Route Table, EC2, EIP, Security Groups
- âœ… Auto-generate GraphQL schema and resolvers using gqlgen
- âœ… ORM-backed models for PostgreSQL
- âœ… GraphQL Playground for CRUD + Infra provisioning
- âœ… AWS and OCI resource composition libraries
- âœ… REST-like GraphQL mutations for managing cloud infrastructure

---

## ğŸ§± Project Structure

```
.
â”œâ”€â”€ awscompose/               # AWS-specific resource creation (VPC, EC2, Subnet, etc.)
â”œâ”€â”€ ocicompose/               # OCI-specific resource modules (VCN, Compartment, etc.)
â”œâ”€â”€ graph/                    # gqlgen schema, resolvers, models
â”‚   â”œâ”€â”€ schema.graphqls       # GraphQL schema
â”‚   â”œâ”€â”€ schema.resolvers.go   # Manual resolvers
â”‚   â”œâ”€â”€ generated.go          # Auto-generated by gqlgen
â”‚   â”œâ”€â”€ db.go                 # DB connection
â”œâ”€â”€ server.go                 # App entry point
â”œâ”€â”€ script.sql                # PostgreSQL schema
â”œâ”€â”€ samplequeries.txt         # Sample GraphQL mutations & queries
â”œâ”€â”€ go.mod / go.sum           # Module dependencies
â”œâ”€â”€ .env                      # Environment config
â””â”€â”€ gqlgen.yml                # gqlgen configuration
```

---

## ğŸš€ How to Run

### Prerequisites

- Go 1.18+
- PostgreSQL running locally
- AWS credentials configured (`~/.aws/credentials`)
- Optional: OCI config (`~/.oci/config`)

### Setup & Start

```bash
git clone https://github.com/paihari/go-pg-gqlgen.git
cd go-pg-gqlgen

# Set Go module mode
export GO111MODULE=on

# Run the server
go run ./server.go
```

Open browser: [http://localhost:8080](http://localhost:8080)

Youâ€™ll see the **GraphQL Playground**.

---

## âœ¨ Sample Query

```graphql
mutation {
  createVpc(input: {
    name: "test-vpc"
  }) {
    id
    name
  }
}
```

More examples in [`samplequeries.txt`](./samplequeries.txt)

---

## ğŸ”„ Supported Tables & Cloud Resources

| Table                     | GQL CRUD | Cloud Provisioning |
|---------------------------|----------|---------------------|
| domains, classes, stages  | âœ… Yes   | âŒ No              |
| buckets, dbs, backups     | âœ… Yes   | âœ… Yes             |
| vpcs, subnets, gateways   | âœ… Yes   | âœ… Yes             |
| security groups, eip, EC2 | âœ… Yes   | âœ… Yes             |

---

## âš™ï¸ Infra Flow (AWS)

1. Create VPC â†’ Internet Gateway â†’ Route Table â†’ Subnet
2. Create Security Group â†’ Network Interface â†’ Elastic IP
3. Launch EC2 Instance (Ubuntu)
4. Configure Apache inside instance

---

## ğŸ§© Next Steps

- ğŸ³ Dockerize & deploy
- ğŸ§ª Unit tests for resolvers
- ğŸŒ OCI extension: Automate VCN and compartments
- ğŸ” Add RBAC for GraphQL queries

---

## ğŸ“˜ References

- gqlgen: https://gqlgen.com/
- AWS SDK Go v2: https://aws.github.io/aws-sdk-go-v2/
- OCI Go SDK: https://docs.oracle.com/en-us/iaas/tools/go-sdk.html

---

## âœï¸ Author

Built by [@paihari](https://github.com/paihari) â€“ enabling full-stack, multi-cloud infrastructure orchestration with GraphQL and Go.
